<?xml version="1.0" encoding="UTF-8"?>

<?import de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<StackPane xmlns="http://javafx.com/javafx/17.0.2-ea"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="bookrecommender.valutazioni.ValutazioniController"
           fx:id="rootPane"
           stylesheets="@styles.css"
           prefHeight="700.0" prefWidth="1100.0">

    <children>
        <Canvas fx:id="backgroundCanvas" />

        <VBox alignment="TOP_CENTER" spacing="0">
            <!-- Header standardizzato -->
            <StackPane styleClass="view-header">
                <padding>
                    <Insets top="20" right="40" bottom="20" left="40"/>
                </padding>
                <HBox alignment="CENTER_LEFT">
                    <Button fx:id="backButton" text="← Torna alla Dashboard" onAction="#handleBack" styleClass="header-back-button"/>
                </HBox>
                <VBox alignment="CENTER" mouseTransparent="true">
                    <Label text="⭐ Le Mie Recensioni" styleClass="header-title"/>
                    <Label fx:id="subtitleLabel" text="Gestisci le valutazioni che hai dato ai libri" styleClass="header-subtitle"/>
                </VBox>
            </StackPane>

            <!-- Contenuto principale -->
            <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="library-scroll-pane" VBox.vgrow="ALWAYS">
                <VBox alignment="TOP_CENTER" spacing="25">
                    <padding>
                        <Insets top="30" right="40" bottom="40" left="40"/>
                    </padding>
                    <HBox alignment="TOP_LEFT" spacing="30" maxWidth="1200" VBox.vgrow="ALWAYS">
                        <!-- Colonna sinistra: lista delle valutazioni -->
                        <VBox spacing="20" prefWidth="400" styleClass="library-panel" HBox.hgrow="SOMETIMES">
                            <padding>
                                <Insets top="25" right="25" bottom="25" left="25"/>
                            </padding>
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label styleClass="section-icon" text="📝"/>
                                <Label text="Le tue valutazioni" styleClass="section-title"/>
                            </HBox>
                            <Label text="Fai clic su una valutazione per visualizzarne i dettagli, modificarla o eliminarla." styleClass="info-text" wrapText="true"/>
                            <ListView fx:id="valutazioniListView" styleClass="library-list-view" VBox.vgrow="ALWAYS"/>
                        </VBox>

                        <!-- Colonna destra: pannello dei dettagli -->
                        <VBox spacing="20" styleClass="library-panel" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets top="25" right="25" bottom="25" left="25"/>
                            </padding>
                            
                            <!-- Placeholder quando non c'è selezione -->
                            <VBox fx:id="placeholderPanel" alignment="CENTER" spacing="15" VBox.vgrow="ALWAYS" managed="true" visible="true">
                                <Label text="⭐" styleClass="placeholder-icon"/>
                                <Label text="Nessuna valutazione selezionata" styleClass="placeholder-title"/>
                                <Label text="Seleziona una recensione dalla lista a sinistra per vederne i dettagli." styleClass="placeholder-text" wrapText="true"/>
                            </VBox>
                            
                            <!-- Pannello dei dettagli (visibile solo quando una valutazione è selezionata) -->
                            <VBox fx:id="detailPanel" spacing="18" visible="false" managed="false" VBox.vgrow="ALWAYS">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Label styleClass="section-icon" text="✍️"/>
                                    <Label text="Dettagli Valutazione" styleClass="section-title"/>
                                </HBox>
                                <Label fx:id="selectedValutazioneInfo" text="Libro: Titolo del Libro (Libreria: Nome Libreria)" styleClass="info-text" wrapText="true"/>
                                
                                <!-- Griglia per punteggi e note -->
                                <GridPane hgap="15" vgap="12">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="180"/>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                                    </columnConstraints>

                                    <!-- Header griglia -->
                                    <Label text="Criterio" styleClass="criterio-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <Label text="Punteggio" styleClass="criterio-label" GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                                    <Label text="Note Personali" styleClass="criterio-label" GridPane.columnIndex="2" GridPane.rowIndex="0"/>

                                    <!-- Stile -->
                                    <Label text="Stile" styleClass="criterio-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                    <HBox fx:id="stileStarsBox" spacing="6" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                                    <TextArea fx:id="stileNote" styleClass="input-field" prefRowCount="1" wrapText="true" GridPane.columnIndex="2" GridPane.rowIndex="1"/>

                                    <!-- Contenuto -->
                                    <Label text="Contenuto" styleClass="criterio-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                    <HBox fx:id="contenutoStarsBox" spacing="6" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                    <TextArea fx:id="contenutoNote" styleClass="input-field" prefRowCount="1" wrapText="true" GridPane.columnIndex="2" GridPane.rowIndex="2"/>

                                    <!-- Gradevolezza -->
                                    <Label text="Gradevolezza" styleClass="criterio-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                    <HBox fx:id="gradevolezzaStarsBox" spacing="6" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                                    <TextArea fx:id="gradevolezzaNote" styleClass="input-field" prefRowCount="1" wrapText="true" GridPane.columnIndex="2" GridPane.rowIndex="3"/>

                                    <!-- Originalità -->
                                    <Label text="Originalità" styleClass="criterio-label" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                                    <HBox fx:id="originalitaStarsBox" spacing="6" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="4"/>
                                    <TextArea fx:id="originalitaNote" styleClass="input-field" prefRowCount="1" wrapText="true" GridPane.columnIndex="2" GridPane.rowIndex="4"/>

                                    <!-- Edizione -->
                                    <Label text="Edizione" styleClass="criterio-label" GridPane.columnIndex="0" GridPane.rowIndex="5"/>
                                    <HBox fx:id="edizioneStarsBox" spacing="6" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="5"/>
                                    <TextArea fx:id="edizioneNote" styleClass="input-field" prefRowCount="1" wrapText="true" GridPane.columnIndex="2" GridPane.rowIndex="5"/>
                                </GridPane>
                                
                                <!-- Voto complessivo e commento finale -->
                                <VBox spacing="10">
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Label text="Voto Complessivo:" styleClass="criterio-label"/>
                                        <Label fx:id="votoComplessivoLabel" text="0.0" styleClass="media-utenti-value"/>
                                        <HBox fx:id="overallStarsBox" spacing="4" alignment="CENTER_LEFT"/>
                                    </HBox>
                                    <Label text="Commento Finale:" styleClass="criterio-label"/>
                                    <TextArea fx:id="commentoFinale" styleClass="input-field" prefRowCount="3" wrapText="true"/>
                                </VBox>

                                <!-- Pulsanti di azione -->
                                <HBox spacing="15" alignment="CENTER_RIGHT">
                                    <Button fx:id="cancelButton" text="Annulla" onAction="#handleCancel" styleClass="text-button"/>
                                    <Button fx:id="deleteButton" text="Elimina" onAction="#handleDelete" styleClass="library-danger-button"/>
                                    <Button fx:id="saveButton" text="Salva Modifiche" onAction="#handleSave" styleClass="library-primary-button"/>
                                </HBox>
                                <Label fx:id="messageLabel" text="" minHeight="20" wrapText="true" styleClass="suggestion-label"/>
                            </VBox>
                        </VBox>
                    </HBox>
                </VBox>
            </ScrollPane>
        </VBox>
    </children>

</StackPane>
